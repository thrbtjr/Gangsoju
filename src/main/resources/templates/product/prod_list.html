<!DOCTYPE html>

<!--
  작성자: 김주현
-->

<html lang="ko" class="" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{includes/head :: head}"></head>

  <body>
    <!-- Loading -->
    <div style="display: none">
      <div id="loadingBarDiv" style="display: none"></div>
    </div>
    <!-- //Loading -->

    <!-- ################## hsome_allContents_wrapper start­ ################## -->
    <div class="hsome_allContents_wrapper">
      <div class="hsome_allContents">
        <!-- ################## header ################## -->
        <header class="hsome_header">
          <h1 class="h_ttl ellipsis" id="headerTitle"></h1>
          <script type="text/javascript">
            $(document).ready(function () {});
            function goSearchPage() {
              $("#searchForm").addClass("visible active activated");
            }
          </script>

          <a href="javascript:noLink();" onclick="goBack();" class="h_prev"
            >이전 페이지로 가기</a
          >
          <ul class="h_gnbMenu">
            <li class="search">
              <a onclick="goSearchPage();"><span>search</span></a>
            </li>
            <li class="cart">
              <a href="/cart"><span>cart</span></a>
            </li>
          </ul>
        </header>
        <!-- //################## header ################## -->

        <div id="listBodyTemp" style="display: none"></div>
        <form id="categoryListForm" action="/p/api/c/categories">
          <input type="hidden" id="brandCode" name="brandCode" value="" />
          <input type="hidden" id="brandName" name="brandName" value="" />
          <input type="hidden" id="subBrand" name="subBrand" value="" />
          <input
            type="hidden"
            id="categoryCode"
            name="categoryCode"
            th:value="${categoryCode}"
          />
          <input
            type="hidden"
            id="mainCateFlag"
            name="mainCateFlag"
            value="false"
          />
          <input
            type="hidden"
            id="repProdColorCode"
            name="repProdColorCode"
            value=""
          />
          <input
            type="hidden"
            id="repSizeEnumCode"
            name="repSizeEnumCode"
            value=""
          />
          <input
            type="hidden"
            id="priceOrderCode"
            name="priceOrderCode"
            value=""
          />
          <input
            type="hidden"
            id="productOrderCode"
            name="productOrderCode"
            value="NEW"
          />
          <input
            type="hidden"
            id="checkSaleCode"
            name="checkSaleCode"
            value="false"
          />
          <input type="hidden" id="rememberPage" name="rememberPage" value="" />
          <!-- 뒤로가기 버튼 클릭시 페이징 기억용 -->
        </form>
        <!-- ################## contents ################## -->
        <div class="hs_product_list_wrap">
          <div class="cate_wrap191028">
            <!-- 중분류 보는 버튼 s-->
            <div
              th:unless="${cateInfo.chooseCatenoLen eq 2}"
              class="previous_category191028"
            >
              <div class="cate_icon">
                <a href="#;">이전카테고리아이콘</a>
              </div>
              <div class="cate_list">
                <ul>
                  <li>
                    <a
                      th:href="|/c/${cateInfo.bigCategory.cateno}|"
                      class="two_link"
                      >전체보기</a
                    >
                  </li>
                  <li th:each="ca : ${cateInfo.middleCategories}">
                    <a
                      th:href="|/c/${ca.cateno}|"
                      class="two_link"
                      th:text="${ca.catename}"
                    ></a>
                  </li>
                </ul>
                <a href="#;" class="btn_ul_close191028"> <span>닫기</span> </a>
              </div>
            </div>
            <!--//중분류 보는 버튼 e -->

            <!-- flag_wrap -->
            <div
              class="flag_wrap case swiper-container swiper-container-horizontal swiper-container-free-mode swiper-container-wp8-horizontal"
              th:classappend="${cateInfo.chooseCatenoLen ne 2} ? 'depth2' : '' "
            >
              <!-- //전체보기 아닌 case(이전카테고리 노출될경우) class 추가-->
              <ul class="swiper-wrapper">
                <li
                  th:if="${cateInfo.chooseCatenoLen eq 2}"
                  class="swiper-slide flag on swiper-slide-active"
                  id="categoryNav01"
                  style="margin-right: 6px; width: fit-content"
                >
                  <a th:href="|/c/${cateInfo.chooseCateno}|" class="name"
                    >&nbsp;전체</a
                  >
                </li>
                <li
                  th:if="${cateInfo.chooseCatenoLen eq 4}"
                  class="swiper-slide flag on swiper-slide-active"
                  id="categoryNav01"
                  style="margin-right: 6px; width: fit-content"
                >
                  <a
                    th:href="|/c/${cateInfo.chooseCateno}|"
                    class="name"
                    th:text="|${cateInfo.categories.parentCategory.catename} 전체|"
                    >&nbsp;전체1</a
                  >
                </li>
                <li
                  th:if="${cateInfo.chooseCatenoLen eq 5}"
                  class="swiper-slide flag swiper-slide-active"
                  style="margin-right: 6px; width: fit-content"
                >
                  <a
                    th:href="|/c/${cateInfo.chooseCateno}|"
                    class="name"
                    th:text="|${cateInfo.categories.parentCategory.catename} 전체|"
                    >&nbsp;전체2</a
                  >
                </li>
                <li
                  th:each="ca : ${cateInfo.categories.categories}"
                  class="swiper-slide flag"
                  style="margin-right: 6px; width: fit-content"
                  th:classappend="${ca.cateno eq cateInfo.chooseCateno} ? 'on' : ''"
                  th:id="${ca.cateno eq cateInfo.chooseCateno} ? 'categoryNav01' : ''"
                >
                  <a
                    th:href="|/c/${ca.cateno}|"
                    th:text="${ca.catename}"
                    class="name"
                  ></a>
                </li>
                <!-- #1141 - 상위 카테고리(여성/남성/패션잡화/라이프스타일 처리) -->
              </ul>
            </div>
            <!--// flag_wrap -->
          </div>
          <script type="text/javascript">
            $(document).ready(function () {
              if ("false" == "true") {
                // 브랜드
                if ("true" == "false") {
                  // 전체보기
                  if ("N" == "Y") {
                    if ("false" == "true") {
                      var innerHtml =
                        "<li><a href=\"/ko/c/we09\" onclick=\"GA_Event('브랜드 전체보기', '룩북/스페셜샵', 'SPECIAL SHOP');\" ><span>SPECIAL SHOP</span></a></li>";
                      $(".brand-quick-tab-link ul").append(innerHtml);
                    }
                    $(".brand-quick-tab-link").show();
                  }
                }
              }
            });
          </script>
          <!-- sort_tit -->
          <div class="sort_tit">
            <p class="num_txt" id="totalSpan"></p>
          </div>
          <!--// sort_tit -->
          <!-- filter_wrap -->
          <!--// filter_wrap -->
          <div class="prodcut_top_cont" id="categoryTopBanner"></div>
          <!-- product_list start-->
          <div class="hs_product_list" id="hsProductList">
            <ul id="listBody"></ul>
          </div>
          <!--// product_list end -->
          <div class="hsome_loader pos_b" style="display: none"></div>
        </div>
        <div th:replace="~{product/search :: searchForm}"></div>
        <!-- //################## contents end ################## -->

        <!-- //레이어 팝업 -->
        <script th:replace="~{includes/footer :: footer_script}"></script>

        <script>
          $(window).load(function () {
            function noticeRolling() {
              if (notiCnt > 1) {
                height = 20;
                num = notiCnt;
                max = height * num;
                move += height;

                //메인여부 체크(메인진입시 1개, 메인탭별 푸터 진입시 1개씩 추가)
                if ($(".notice-wrap").length > 1) {
                  $("#topNav1909 li").each(function (index) {
                    if ($(this).hasClass("on")) {
                      curTabId = index;
                    }
                  });
                  $("footer#footer" + curTabId + " .notice-wrap").animate(
                    { top: -move },
                    600,
                    function () {
                      if (move >= max) {
                        $(this).css("top", 0);
                        move = 0;
                      }
                    }
                  );
                } else {
                  $(".notice-wrap").animate({ top: -move }, 600, function () {
                    if (move >= max) {
                      $(this).css("top", 0);
                      move = 0;
                    }
                  });
                }
              }
            }
            noticeRollingOff = setInterval(noticeRolling, 3000);

            //메인여부 체크(메인진입시 1개, 메인탭별 푸터 진입시 1개씩 추가)
            if ($(".notice-wrap").length > 1) {
              $("#topNav1909 li").each(function (index) {
                if ($(this).hasClass("on")) {
                  curTabId = index;
                }
              });
              $("footer#footer" + curTabId + " .notice-wrap").append(
                $("footer#footer" + curTabId + " .notice-wrap li")
                  .first()
                  .clone()
              );
            } else {
              $(".notice-wrap").append($(".notice-wrap li").first().clone());
            }
          });
        </script>
        <form
          id="autologinForm"
          name="autologinForm"
          action="/ko/hp/autologin"
          method="get"
        >
          <input type="hidden" name="hcid" id="hcid" value="e2gaf@naver.com" />
        </form>
        <footer th:replace="~{includes/footer :: footer}"></footer>
      </div>
    </div>
    <!-- ################## //hsome_allContents_wrapper end­ ################## -->
    <a href="noLink();" class="hsome_topBtn upper" id="handsomeTopBtn"
      >mobile.bottom.top</a
    >
    <!-- 20180530 추가 -->

    <!-- ################## hsome_quickMenu | 퀵메뉴 ################## -->
    <script th:replace="~{includes/quick :: quick_script}"></script>
    <aside th:replace="~{includes/quick :: quick}"></aside>
    <!-- ################## //hsome_quickMenu | 퀵메뉴 ################## -->

    <div class="fixed_dim_layer" onclick="familySiteSelectClosed();"></div>
    <div
      th:replace="~{includes/footer :: family}"
      class="family_site_popup_191108"
    ></div>
    <!-- ################## hsome_quickMenu_contents | 퀵메뉴 컨텐츠 영역 ################## -->
    <div class="hsome_quickMenu_contents"></div>
    <!-- //################## hsome_quickMenu_contents | 퀵메뉴 컨텐츠 영역 ################## -->

    <script type="text/javascript">
      $(document).ready(function () {
        if (false) {
          $("#cateTab").click();
        }
      });

      function closeAction() {
        $(".twoDepthNavPopup").hide();
        $(".one_lists.on").toggleClass("on");
      }
    </script>

    <!-- 180806 ìì // -->
    <div id="mainPage_wrapper_cover"></div>
    <!-- //180806 ìì  -->

    <script>
      $(document).ready(function () {
        var appVersionCheckOS = getCookie("app");
        var appVersionCheckVer = getCookie("appVer");
        if (
          (appVersionCheckOS == "ios" && appVersionCheckVer.startsWith("1.")) ||
          (appVersionCheckOS == "android" && appVersionCheckVer < 43)
        ) {
          location.href = "/ko/mobilecommon/appDownload";
          return;
        }

        var todayDate = new Date();

        if (getCookie("mainNoticeWrapKo") != todayDate.getDate()) {
          var innerHtml = "";
          innerHtml +=
            '<div class="notice_pop" id="mainNoticeWrap" style="z-index:100000;">                                                                              ';
          innerHtml +=
            '    <div class="popwrap_renewal1910" id="mainNoticeWrapKo">                                                                                       ';
          innerHtml +=
            '        <div class="pop_cnt">                                                                                                                     ';
          innerHtml +=
            '            <h3 class="pop_tlt" style="font-size:20px">                                                                                           ';
          innerHtml +=
            "            아이폰 APP <br>                                                                                                                       ";
          innerHtml +=
            "            카드결제 불가 안내                                                                                                                    ";
          innerHtml +=
            "            </h3>                                                                                                                                 ";
          innerHtml +=
            '            <p class="pop_txt">                                                                                                                   ';
          innerHtml +=
            "            아이폰 APP 2.2.2 버전에서<br/>일부 결제 오류가 발생하고 있습니다.<br/>(원클릭결제는 정상)<br/><br/>                                   ";
          innerHtml +=
            "            2.2.3 버전으로 업데이트 하시면<br/>정상 결제가 가능합니다.<br/>업데이트 후, 결제 진행 부탁드립니다.<br/><br/>                         ";
          innerHtml +=
            "            고객님께 불편을 드려 죄송합니다.                                                                                                      ";
          innerHtml +=
            "            </p>                                                                                                                                  ";
          innerHtml +=
            "        </div>                                                                                                                                    ";
          innerHtml +=
            '        <div class="btnwrap">                                                                                                                     ';
          innerHtml +=
            '            <input type="button" class="btn stoptoday closeLayerPopup" value="오늘은 그만보기 ">                                                  ';
          innerHtml +=
            '            <input type="button" class="btn close closeLayerPopup" value="닫기">                                                                  ';
          innerHtml +=
            "        </div>                                                                                                                                    ";
          innerHtml +=
            '        <a href="#" class="btn_close closeLayerPopup"></a>                                                                                        ';
          innerHtml +=
            "    </div>                                                                                                                                        ";
          innerHtml += "</div> ";
          innerHtml +=
            '<div style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:9999;" id="notice_pop_layer"><div style="position:fixed; top:0; left:0; width:100%; height:100%; background:#fff; opacity:0;"></div> </div> ';

          if (appVersionCheckOS == "ios" && appVersionCheckVer == "2.2.2") {
            if ("productList" == "ordersheet" || "productList" == "cartPage") {
              $(".hsome_contents").after(innerHtml);
              $("#notice_pop_layer").show();
            }
          }
        }

        $(".closeLayerPopup").on("click", function () {
          $("#notice_pop_layer").hide();
          if ($(this).hasClass("stoptoday")) {
            //오늘은 그만보기
            var todayDate = new Date();
            var cookieId = $(this).parents(".popwrap_renewal1910").attr("id");
            setOneDayCookie(cookieId, todayDate.getDate(), 1);
          }
          $(this).parents(".popwrap_renewal1910").css("display", "none");
        });

        if (handsomePageId != "mainIntro") {
          if ($.cookie("handsomecategorypagecnt") !== null) {
            $.removeCookie("handsomecategorypagecnt", { path: "/" });
          }
          if ($.cookie("handsomecategoryscroll") !== null) {
            $.removeCookie("handsomecategoryscroll", { path: "/" });
          }
          if ($.cookie("handsomelayerscroll") !== null) {
            $.removeCookie("handsomelayerscroll", { path: "/" });
          }
          if (
            $.cookie("handsomeproductback") !== null &&
            handsomePageId != "productList"
          ) {
            $.removeCookie("handsomeproductback", { path: "/" });
          }
          if (
            $.cookie("handsomecategoryhash") !== null &&
            !(
              handsomePageId == "productList" ||
              handsomePageId == "hsProductDetailPage"
            )
          ) {
            $.removeCookie("handsomecategoryhash", { path: "/" });
          }
        }

        $(document).on("click", ".set", function () {
          location.href = "/ko/mypage/configMain";
        });
      });

      // 쿠키 생성
      function setCookie(cName, cValue, cDay) {
        var expire = new Date();
        expire.setDate(expire.getDate() + cDay);
        cookies = cName + "=" + escape(cValue) + "; path=/ ";
        if (typeof cDay != "undefined")
          cookies += ";expires=" + expire.toGMTString() + ";";
        document.cookie = cookies;
      }

      //쿠키 삭제
      function deletecookie(name, pram_searchwords) {
        var today = new Date();
        var path = "/ko/";
        var lastIndex = path.lastIndexOf("/");
        path = path.substring(0, lastIndex);
        today.setDate(today.getDate() + -1);
        document.cookie =
          name + "=; path=" + path + "; expires=" + today.toGMTString() + ";";
        $("." + pram_searchwords).css("display", "none");
      }

      function deletecookiePath(name, pram_searchwords, path) {
        var today = new Date();
        if (path == "") {
          path = "/";
        }
        today.setDate(today.getDate() + -1);
        document.cookie =
          name + "=; path=" + path + "; expires=" + today.toGMTString() + ";";
        if (pram_searchwords != "") {
          $("." + pram_searchwords).css("display", "none");
        }
      }

      //언어설정

      function slideOnMain() {
        var autocom_swiper = new Swiper("#autocompleteImg", {
          slidesPerView: 3.333,
          paginationClickable: false,
          spaceBetween: "1.5625%",
          freeMode: true,
        });
      }

      //상품 검색 오픈
      function getProductSearchPage() {
        layerPopupOpen(
          "/ko/mobilecommon/productsearch",
          ".hsome_layerpop_contents.lp_depth1",
          ".layerpop_wrap.lp_cs_qna_search_wrap"
        );
      }

      //상품 검색 닫기
      function productSearchPageClose() {
        $(".layerpop_wrap.lp_cs_qna_search_wrap .ui_tab").find(".fcs").remove();
        layerPopupClose(
          ".hsome_layerpop_contents.lp_depth1",
          ".layerpop_wrap.lp_cs_qna_search_wrap"
        );
        // SNS 댓글의 경우 검색창 닫기 후 댓글창 active
        if (window.isSnsReplySearchPop) {
          $(".sns_comment_ipt_pop .sns-comment-ipt").addClass("active");
        }
      }

      //상품 검색 오픈
      function getProductSearchPage2() {
        layerPopupOpen(
          "/ko/mobilecommon/productsearch?type=manto",
          ".hsome_layerpop_contents.lp_depth1",
          ".layerpop_wrap.lp_cs_qna_search_wrap2"
        );
      }

      //상품 검색 닫기
      function productSearchPageClose2() {
        layerPopupClose(
          ".hsome_layerpop_contents.lp_depth1",
          ".layerpop_wrap.lp_cs_qna_search_wrap2"
        );
        // SNS 댓글의 경우 검색창 닫기 후 댓글창 active
        if (window.isSnsReplySearchPop) {
          $(".sns_comment_ipt_pop .sns-comment-ipt").addClass("active");
        }
      }

      //상품상세 > 상품 검색 오픈
      function getProductSearchPageOnProductDetail() {
        layerPopupOpen(
          "/ko/mobilecommon/productsearch",
          ".hsome_layerpop_contents.lp_depth2",
          ".layerpop_wrap.lp_cs_qna_search_wrap"
        );
        setTimeout(function () {
          $(
            ".hsome_layerpop_contents.lp_depth2 .lyrpp_close.lyrpp_close_stl1"
          ).attr("onclick", "productSearchPageOnProductDetailClose();");
        }, 400);
      }

      //상품 검색 닫기
      function productSearchPageOnProductDetailClose() {
        $(".layerpop_wrap.lp_cs_qna_search_wrap .ui_tab").find(".fcs").remove();
        layerPopupClose(
          ".hsome_layerpop_contents.lp_depth2",
          ".layerpop_wrap.lp_cs_qna_search_wrap"
        );
        // SNS 댓글의 경우 검색창 닫기 후 댓글창 active
        if (window.isSnsReplySearchPop) {
          $(".sns_comment_ipt_pop .sns-comment-ipt").addClass("active");
        }
      }

      //레이어 팝업 오픈
      function layerPopupOpen(url, layer, pop) {
        $.cookie("handsomelayerscroll", $(document).scrollTop(), { path: "/" });
        $(layer).addClass("active");

        setTimeout(function () {
          $(".hsome_allContents").addClass("disabled");
        }, 300);
        setTimeout(function () {
          $(layer).addClass("visible");
        }, 400);

        $(layer).html(
          '<img src="/_ui/handsomemobile/images/common/Spinner-1s-200px.png" alt="loading" class="hsome_quickMenu_loader" />'
        );

        jQuery.ajax({
          url: url,
          data: "",
          type: "get",
          success: function (data) {
            setTimeout(function () {
              $(layer).html(data);
              $(pop).addClass("visible");
            }, 0);
            setTimeout(function () {
              $(pop).addClass("active");
            }, 0);
            setTimeout(function () {
              $(pop).addClass("activated");
            }, 400);
          },
        });
      }

      //레이어 팝업 닫기
      function layerPopupClose(layer, pop) {
        var $popup = $(this).closest(pop);
        $popup.removeClass("activated");
        $popup.removeClass("active");
        setTimeout(function () {
          $popup.removeClass("visible");
          $(".hsome_allContents").removeClass("disabled");
          $(layer).removeClass("active");
          $(layer).removeClass("visible");
          if ($.cookie("handsomelayerscroll") !== null) {
            $(document).scrollTop(getCookie("handsomelayerscroll"));
          }
        }, 400);
        return false;
      }

      //레이어 팝업 닫기
      function layerPopupClose2(layer, pop) {
        $(pop).removeClass("activated");
        $(pop).removeClass("active");
        setTimeout(function () {
          $(pop).removeClass("visible");
          $(".hsome_allContents").removeClass("disabled");
          $(layer).removeClass("active");
          $(layer).removeClass("visible");
          if ($.cookie("handsomelayerscroll") !== null) {
            $(document).scrollTop(getCookie("handsomelayerscroll"));
          }
        }, 400);
        return false;
      }

      function ftLogout() {
        deletecookie("UID");
        deletecookie("criteoEmail");
        deletecookie("memberGb");

        location.href = "/ko/logout";
      }

      var oneclick = {
        isEvent: false,
        depthIndex: 0,
        open: function (products, vipDeliAvail) {
          var broadcastIndex = "";
          var inflowTime = "";
          var broadcastDate = "";
          if (broadcastIndex != "") {
            inflowTime = "20230208100854";
          }

          if (this.isEvent) return;

          this.depthIndex = layerNextActiveIndex();
          $(".hsome_layerpop_contents.lp_depth" + this.depthIndex).css(
            "bottom",
            "-1000px"
          );
          $(".hsome_layerpop_contents.lp_depth" + this.depthIndex).load(
            "/ko/checkout/oneclick?products=" +
              products +
              "&vipDeliAvail=" +
              vipDeliAvail +
              "&broadcastIndex=" +
              broadcastIndex +
              "&inflowTime=" +
              inflowTime +
              "&broadcastDate=" +
              broadcastDate,
            function () {
              $(this)
                .removeClass("lp_stl_black")
                .removeClass("lp_stl_trans")
                .removeClass("dir_w")
                .removeClass("dir_h");
              $(this).addClass(
                "dir_h lp_stl_black lp_stl_trans visible active"
              );
              oneclick.isEvent = true;
            }
          );
        },
        calliFramePopup: function (depth) {
          $(".iframe_popup_wrap")
            .removeClass("lp_stl_black")
            .removeClass("lp_stl_trans")
            .removeClass("dir_w")
            .removeClass("dir_h"); //초기화
          curScrollPosition = $(window).scrollTop();
          holdBodyShow();
          $(".iframe_popup_wrap").addClass("dir_h"); //슬라이드방향
          return false;
        },
        init: function () {
          if (this.isEvent) return;

          if (window.addEventListener) {
            window.addEventListener("message", oneclickPostMessage, false);
          } else if (window.attachEvent) {
            window.attachEvent("onmessage", oneclickPostMessage, false);
          }

          this.isEvent = true;
        },
      };

      function oneclickPostLoaded() {
        $(".iframe_popup_wrap").addClass("lp_stl_trans"); //black 배경 활성화
        $(".iframe_popup_wrap").addClass("visible");
        $(".iframe_popup_wrap").addClass("active");
      }

      function oneclickPostSubmit(data) {
        var payForm = data,
          formName = "oneclickPayForm";

        if ($("#" + formName).length > 0) {
          $("#" + formName).remove();
        }
        var $oneclickPayForm = $("<form/>", {
          id: formName,
          enctype: "application/x-www-form-urlencodeed",
        }).appendTo($("body"));
        $oneclickPayForm.empty();

        $.each(payForm, function (name, value) {
          addHidden($oneclickPayForm, name, value);
        });

        $oneclickPayForm.attr({
          method: "POST",
          action:
            "https://www.thehandsome.com/ko/inicis/inipaywpay/sop/response",
          target: "_top",
        });

        $oneclickPayForm.submit();
      }

      function oneclickPostPointSubmit(data) {
        var payForm = data,
          formName = "oneclickPayForm";

        if ($("#" + formName).length > 0) {
          $("#" + formName).remove();
        }

        var $oneclickPayForm = $("<form/>", {
          id: formName,
        }).appendTo($("body"));
        $oneclickPayForm.empty();

        $.each(payForm, function (name, value) {
          addHidden($oneclickPayForm, name, value);
        });
        $oneclickPayForm.attr({
          method: "POST",
          action: "https://www.thehandsome.com/ko/checkout/placepoint",
          target: "_top",
        });
        $oneclickPayForm.submit();
      }

      function payFormData(data) {
        var payForm = data,
          formName = "PAY_FORM";

        if ($("#" + formName).length > 0) {
          $("#" + formName).remove();
        }
        var $oneclickPayForm = $("<form/>", {
          id: formName,
        }).appendTo($("body"));
        $oneclickPayForm.empty();

        $.each(payForm, function (name, value) {
          addHidden($oneclickPayForm, name, value);
        });
      }

      function requestPaymentSubmit(data) {
        WPAY.paymentAuthSubmit(data);
      }

      function oneclickPostClose() {
        $.get("/ko/shoppingbag/oneclickCancel");
        holdBodyHide();
        if (oneclick.depthIndex > 0) {
          $(".lp_oneclick_buy_pay_wrap").removeClass("visible");
          $(".lp_oneclick_buy_pay_wrap").removeClass("active");
        } else {
          $(".iframe_popup_wrap").removeClass("visible");
          $(".iframe_popup_wrap").removeClass("active");
        }

        $(".hs_pro_view_floating .floating_box").removeClass("active");
        $(".hs_pro_view_floating .floating_box").eq(1).addClass("active");

        $("#onclickLodingArea").hide();
        $("#lpOrderApplyBtns").show();
        $("#lyrppTopColseArea").show();

        $("body").css({ marginTop: curScrollPosition * -1 });
        setTimeout(function () {
          $("body").css({ marginTop: 0 });
          $("body").scrollTop(curScrollPosition);

          if (oneclick.depthIndex > 0) {
            $(
              ".hsome_layerpop_contents.lp_depth" + oneclick.depthIndex
            ).empty();
            $(
              ".hsome_layerpop_contents.lp_depth" + oneclick.depthIndex
            ).removeClass("dir_h lp_stl_black lp_stl_trans visible active");
            oneclick.isEvent = false;
          } else {
            $(".iframe_popup_wrap").remove();
          }
        }, 400);
      }

      function oneclickPostMovePage(data) {
        location.href = data.url;
      }

      function oneclickPostMessage(event) {
        if ("https://www.thehandsome.com/ko".indexOf(event.origin) == -1)
          return;

        var data = event.data;

        if (typeof window[data.func] == "function") {
          window[data.func].call(null, data.data);
        }
      }

      //쿠키 생성
      function setOneDayCookie(cName, cValue, cDay) {
        var currentDate = new Date();
        var expire = new Date(
          currentDate.getFullYear(),
          currentDate.getMonth(),
          currentDate.getDate() + cDay,
          0,
          0,
          0
        );
        cookies = cName + "=" + escape(cValue) + "; path=/ ";
        if (typeof cDay != "undefined")
          cookies += ";expires=" + expire.toGMTString() + ";";
        document.cookie = cookies;
      }
    </script>
    <div id="iframepopuparea"></div>

    <script
      th:replace="~{includes/popup :: popup_script}"
      type="text/javascript"
    ></script>

    <div th:replace="~{includes/popup :: popup_html}"></div>

    <script>
      $("html").on(
        "scroll touchmove mousewheel",
        ".hold_body .sns_comment_ipt_pop .sns-comment-op",
        function (e) {
          e.preventDefault();
          e.stopPropagation();
          return false;
        }
      );

      $(document).ready(function () {
        $(".write_form_area .reply-write-line #comment").keyup(function (e) {
          var content = $(this).val();
          $(".reply_write_box #counter").html(content.length);
        });

        $(".sns_comment_pop #sns_commont_close").on("click", function () {
          $(".sns_comment_ipt_pop .reply-call-btn").removeClass("on");
          $(".hsome_allContents_wrapper").css("display", "block");
          scrollHeightHistory();
          $(".sns_comment_pop").scrollTop(0);

          $("body").removeClass("hidden");
        });

        $(".reply_write_box").on("focus", "textarea", putBlur);

        // 20200706 댓글 버튼 active 액션
        $(".sns_comment_ipt_pop").on(
          "click",
          ".reply-call-btn > button",
          function () {
            $(".sns_comment_ipt_pop .sns-comment-ipt").addClass("active");
            $(".reply-call-btn").removeClass("on");
            $(".sns-comment-ipt .reply_write_box #counter").html(0);
          }
        );

        $(".sns_comment_ipt_pop").on(
          "click",
          ".reply-close-btn  a",
          function (e) {
            var replu_None = $(
              ".sns_comment_ipt_pop .sns-comment-ipt .ipt-re-uploaded"
            ).hasClass("is-active");
            e.preventDefault();

            $(".sns_comment_ipt_pop .sns-comment-ipt").removeClass("active");
            $(".sns_comment_ipt_pop .reply-call-btn").addClass("on");

            if (replu_None == true) {
              $(
                ".sns_comment_ipt_pop .sns-comment-ipt .ipt-re-uploaded"
              ).removeClass("is-active");
            }
          }
        );

        function putBlur() {
          var $thisTextarea = $(this);
          $(".hsome_layer_popup").on("touchstart", function (e) {
            $thisTextarea.blur();
          });
        }
      });
    </script>

    <!-- 좋아요 목록 팝업 -->
    <div class="hsome_layer_popup hs_sns_like_pop">
      <h2 class="pop-comm-ttl">
        <i class="like"></i>좋아요<span class="normal_txt">(10)</span>
      </h2>
      <div class="pop-comm-cnts">
        <div class="hs_sns_wrap">
          <ul class="hs_sns_member_list"></ul>
        </div>
      </div>
      <div id="paging" class="hs_paging mt30 mb30"></div>
      <a href="#" class="pop-comm-cls" onClick="closeLikePop();">닫기</a>
    </div>
    <!-- //좋아요 목록 팝업 -->

    <!-- sns공유// -->
    <div th:replace="~{includes/sns_share :: sns_html}"></div>
    <script th:replace="~{includes/sns_share :: sns_script1}"></script>
    <script th:replace="~{includes/sns_share :: sns_script2}"></script>
    <!-- //sns공유 -->

    <!-- loading_layerpop s -->
    <!-- layerpop_wrap | 처리중 s -->
    <div class="layerpop_wrap loading_layer_wrap">
      <!-- layerpop_middle s -->
      <div class="lyrpp_mid">
        <div class="loading_box"></div>
      </div>
      <!-- layerpop_middle e -->
    </div>
    <!-- layerpop_wrap | 처리중 e -->

    <!-- 스타일라이브 팝업 20211001 S -->

    <script>
      $(document).ready(function () {
        // 모달 닫기
        $(
          ".stlv-mob-stlv-20211001--closed1, .stlv-mob-stlv-20211001--closed2, .stlv-mob-stlv-20211001--closed3"
        ).on("click", function () {
          $(".stlv-mob-stlv-20211001--popup").css("display", "none");
          setTimeout(function () {
            $(".hsome_quickMenu").removeClass("active");
            //작성 후 메인으로 이동한 뒤 포스트 팝업을 위한 쿠키값 셋팅
            setCookie("isWriteAfter", "Y", 1);
            location.href = "/ko/sns/main?isWriteAfter=true";
            hideLoadingLp();
          }, 1000);
        });
      });
    </script>

    <!-- 스타일라이브 팝업 20211001 E -->

    <!-- 결제시도시 처리중 layper 별도 표시 200217 nih -->
    <div
      class="pop_loading_oneclick200210_wrap"
      style="
        width: 100%;
        height: 100%;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 9998;
        display: none;
      "
    >
      <div
        class="pop_loading_oneclick200210"
        style="
          background: #222;
          width: 90%;
          height: 120px;
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate3d(-50%, -50%, 0);
          z-index: 9999;
        "
      >
        <img
          src="http://cdn.thehandsome.com/_ui/handsomemobile/images/common/Spinner_1s_105px.png"
          alt="loading"
          style="
            display: block;
            width: 32px;
            height: 32px;
            margin: 30px auto 15px auto;
          "
        />
        <p style="color: #fff; text-align: center">
          <span style="color: #fff; font-size: 15px">처리중입니다.</span>
        </p>
      </div>
    </div>

    <!-- loading_layerpop e -->
    <!-- hsome_layer_menu_contents | 레이어팝업메뉴 컨텐츠 영역 e -->
    <!-- layerpopupContent e -->

    <script th:inline="javascript" type="text/javascript">
      //<![CDATA[
      var $currList = $(document.createDocumentFragment());
      //console.log("컬리스트 생성1088 :", $currList);

      var CategoryListController = function (
        formId,
        listArea,
        pageArea,
        pageSize,
        searchBtnId
      ) {
        var t = this; //this의 별칭. each문 등의 this를 사용하지 못하는 공간에서 사용한다.
        console.log("t는? ", t);

        this.PARAMS = {};

        var paging = null;

        this.name = "CategoryListController";
        searchBtnId;
        t.PARAMS.formId = formId;

        t.PARAMS.pageSize = pageSize != null ? pageSize : 10;

        t.PARAMS.paging = new PageNavigationController(pageArea, pageSize);
        t.PARAMS.pageNum = 1;

        t.PARAMS.defaultListHtml = $(listArea).html();

        if (searchBtnId != null) {
          $("#" + searchBtnId).click(function () {
            t.searchAction();
          });
        }

        this.setData = function () {
          t.PARAMS.jsonObjectData = null;
          t.PARAMS.resourceObjectData = null;
          this.getJsonData();
        };

        //데이터 호출
        this.getJsonData = function () {
          //메인 베스트에서 진입시 판매순으로 setting
          var mainBest = "";
          if (mainBest != null && mainBest == "Y") {
            $("#st2").val("SALES");
            $("#productOrderCode").val($("#st2 option:eq(1)").val());
            $("#st2 option:eq(1)").attr("selected", "selected");
          }

          if (categoryListCache.hasPageData(t.PARAMS.pageNum)) {
            console.log("캐시에 있는 데이터..");
            t.PARAMS.jsonObjectData = categoryListCache.getBuffData(
              t.PARAMS.pageNum,
              t.PARAMS.pageSize
            );
            t.makeResource();
          } else {
            //데이터가 없으면

            var paramDatas = "brandCode=" + $("#brandCode").val();
            paramDatas += "&subBrand=" + $("#subBrand").val();
            paramDatas += "&categoryCode=" + $("#categoryCode").val();
            paramDatas += "&mainCateFlag=" + $("#mainCateFlag").val();
            paramDatas += "&repProdColorCode=" + $("#repProdColorCode").val();
            paramDatas += "&repSizeEnumCode=" + $("#repSizeEnumCode").val();
            paramDatas += "&priceOrderCode=" + $("#priceOrderCode").val();
            paramDatas += "&productOrderCode=" + $("#productOrderCode").val();
            paramDatas += "&checkSaleCode=" + $("#checkSaleCode").val();
            paramDatas += "&rememberPage=" + $("#rememberPage").val();

            if (paramDatas != "") paramDatas += "&";
            paramDatas +=
              "pageNum=" + t.PARAMS.pageNum + "&pageSize=" + t.PARAMS.pageSize;

            console.log("ajax 호출~ ", categoryListList.PARAMS.pageNum);
            $.ajax({
              type: "get",
              url: "/p/api/products",
              data: paramDatas,
              dataType: "json",
              error: function (request, status, error) {
                console.log(
                  "code:" +
                    request.status +
                    "\n" +
                    "message:" +
                    request.responseText +
                    "\n" +
                    "error:" +
                    error
                );
                t.PARAMS.jsonObjectData = 0;
                // ajax 호출 실패 시 네트워크 확인 메시지 alert. 181122
                var la = new layerAlert(
                  "네트워크 접속이 원활하지 않습니다. LTE 또는 Wifi 접속 상태를 확인해주세요."
                );
                la.confirmAction = function () {
                  return;
                };
              },
              success: function (result) {
                console.log(result);
                t.PARAMS.jsonObjectData = result;
                t.makeResource();
              },
            });
          }
        }; //서버에서 데이터 호출

        this.makeResource = function () {
          //특별한 데이터 가공이 필요한 경우 오버라이드해서 사용
          t.PARAMS.resourceObjectData = t.PARAMS.jsonObjectData;
        };

        this.doFunction = function () {
          var j = 0;
          var chkTimer = setInterval(chkData, 100); // 1000 = 1초입니다.
          function chkData() {
            if (t.PARAMS.jsonObjectData == null) {
              console.log("do 1200 null", null);
              if (j == 100) clearInterval(chkTimer);
              j++;
              return false;
            } else if (t.PARAMS.jsonObjectData != 0) {
              console.log("do 1200 nullx", t.PARAMS.jsonObjectData);
              clearInterval(chkTimer);
              try {
                t.setListHtml();
              } catch (ex) {
                // setListHtml 호출 시 마지막 단계에서 gubunSearchYn을 클리어하는데,
                // 중간에 예외 발생을 대비하여 catch block 내부에서 다시 한번 clear하는 로직 추가. 181122
                gubunSearchYn = "N";
              }
            } else {
              console.log("do 1200 fail");
              // ajax 호출이 실패한 경우 t.PARAMS.jsonObjectData == 0 이며, gubunSearchYn flag를 clean 한다. 181122
              gubunSearchYn = "N";
            }

            clearInterval(chkTimer);
          }
        };

        this.setListHtml = function () {
          // console.log("들어오나?", t.PARAMS.jsonObjectData);
          var sumListTag = null;
          if (t.PARAMS.jsonObjectData.products != null) {
            console.log("위");
            sumListTag = this.setRowHtml(t.PARAMS.jsonObjectData.products);
          } else {
            console.log("아래");
            sumListTag = this.setRowHtml(t.PARAMS.jsonObjectData);
          }

          if (sumListTag != "") {
            $currList.append(sumListTag);
          }

          this.afterSetAction();
          console.log("=============this.setListHtml");
        };

        /************오버라이드!!***********/
        this.setRowHtml = function (results) {};

        this.searchAction = function () {
          t.PARAMS.pageNum = 1;
          t.doWork();
        };

        this.afterSetAction = function () {
          //혹시 리스트 셋팅 후에 처리해야하는 로직이 있을경우 이 함수 오버라이드해서 사용
        };
      };


      CategoryListController.prototype = new CommonController();
      var categoryListCache = (function (catId) {
        var listStorageId = catId + ".listData",
          stateStorageId = catId + ".pageState",
          cachePageCount = 5;

        var currPageNum,
          keepPageNum = 0;

        ////here
        var compressCategoryList = function (listData) {
          console.log("여기~~~~: compressCategoryList");
          console.log(listData);
          return listData
            .map(function (el) {
              let re =
                el.pid +
                "\f" +
                el.bno +
                "\f" +
                el.bname +
                "\f" +
                el.pname +
                "\f" +
                el.pcprice +
                "\f" +
                el.pcimg2 +
                "\f" +
                el.pcid +
                "\f" +
                el.colors;
              return re;
            })
            .join("\n");
          console.log("=================compressCategoryList");
        };

        var decompressCategoryList = function (compressedArr) {
          console.log("여기~~~~: decompressCategoryList");
          return compressedArr.map(function (el) {
            console.log("\t", el);
            var arr = el.split("\f");
            var result = {
              productImageUrl1: arr[5],
              productStyleCode: arr[6],
              productName: arr[3],
              productColorTemp: JSON.parse(arr[7]),
              productBrandName: arr[2],
              productPrice: arr[4],
              productBaseCode: arr[0],
            };

            console.log("\t decomp_reusult =", result);
            return result;
          });
        };

        ////end

        var removeForwardCache = function () {
          console.log("여기: removeForwardCache");
          var pageQSource = window.sessionStorage.getItem("savedCatId");
          if (pageQSource) {
            var pageQueue = JSON.parse(pageQSource);

            // 현재 페이지의 카테고리 아이디 제거
            for (var idx = pageQueue.length - 1; idx >= 0; idx--) {
              if (pageQueue[idx] != catId) {
                window.sessionStorage.removeItem(pageQueue[idx] + ".listData");
                window.sessionStorage.removeItem(pageQueue[idx] + ".pageState");
              } else {
                // 현재 페이지를 만나면 loop 종료
                window.sessionStorage.setItem(
                  "savedCatId",
                  JSON.stringify(pageQueue.slice(0, idx + 1))
                );
                break;
              }
            }
          }
        };

        if (typeof window.sessionStorage == "undefined" || !catId) {
          console.log("세션이 없는 경우", catId, "!");
          return {

            //세션이 없는 경우
            addListData: function (param) {
              return;
            },
            changePageState: function (param) {
              return;
            },
            loadCacheData: function () {
              return false;
            },
            resetCurrPageCache: function () {
              return;
            },
            initCache: function () {
              return;
            },
            hasPageData: function (pageNum) {
              return false;
            },
            getBuffData: function (pageNum, pageSize) {
              return {};
            },
          };
        } else {
          console.log("여기~~~~~~~~~~ session어쩌고:");

          return {
            addListData: function (param) {
              console.log("여기~~~~~~~~~~ addListData 1366:");
              console.log("파람: ", param);
              if (param.listData) {
                currPageNum = param.pageNum;
                keepPageNum = param.pageNum;
                var savedData = window.sessionStorage.getItem(listStorageId);
                window.sessionStorage.setItem(
                  listStorageId,
                  (savedData ? savedData + "\n" : "") +
                    compressCategoryList(param.listData)
                );
              }
              console.log("============== addListData 1366");
            },

            changePageState: function (param) {
              console.log("여기~~~~~~~~~~ changePageState 1380:");
              var cb = [];
              $(".brndFt").each(function (i) {
                if (this.checked) {
                  cb[i] = $(this).attr("id");
                }
              });
              stateStorageId;

              var data = $.extend(
                {
                  pageNum: currPageNum,
                  isNextPage: isNextPage,
                  nextPageNum: nextPageNum,
                  prodCnt: totalProdCount,
                  keepPageNum: keepPageNum,
                  displayTopPageNUm: displayTopPageNUm,
                  chkBrand: cb,
                  chkSales: $("#checkSale").is(":checked"),
                  selectedSort: $("#st2 option:selected").val(),
                  scrollTop: $(document).scrollTop(),
                },
                param
              );
              window.sessionStorage.setItem(
                stateStorageId,
                JSON.stringify(data)
              );
              console.log("===========changePageState ");
            },

            loadCacheData: function () {
              console.log("여기~~~~~~~~~~ loadCacheData 1412:");
              // history.back으로 이동한 경우 back 하기 전 페이지(forward page)의 cache data가 있으면 제거한다.
              removeForwardCache();

              var data = window.sessionStorage.getItem(listStorageId),
                stateData = window.sessionStorage.getItem(stateStorageId),
                $categoryList = $("#listBody"),
                chkBrand = new Array();

              if (data) {
                var stateObj = $.extend(
                  {},
                  {
                    pageNum: 1,
                    isNextPage: false,
                    nextPageNum: 2,
                    chkBrand: [],
                    scrollTop: 0,
                  },
                  stateData && JSON.parse(stateData)
                );

                // 페이지 상태 데이터를 load한 cache 정보로 초기화
                isNextPage = stateObj.isNextPage;
                nextPageNum = stateObj.nextPageNum;
                currPageNum = stateObj.pageNum;
                totalProdCount = stateObj.prodCnt;
                keepPageNum = stateObj.keepPageNum;
                displayTopPageNUm = stateObj.displayTopPageNUm;
                chkBrand = stateObj.chkBrand;

                // Filter, 4pm, athome, quick checkbox 초기화 후 다시 설정
                $(".product_filter_pop input").prop("checked", false);
                $(".hs_float_check input").prop("checked", false);

                for (var i in chkBrand) {
                  $("#" + chkBrand[i]).click();
                }
                //IOS문제로 인한 brandFilterTitle, brandCode값 중복제거
                var tempCodeValue = "";
                var tempFilterCodeArr = $("#brandCode").val().split(",");
                var tempFilterCode = tempFilterCodeArr.reduce(function (a, b) {
                  if (a.indexOf(b) < 0) a.push(b);
                  return a;
                }, []);

                for (var i = 0; i < tempFilterCode.length; i++) {
                  if (tempCodeValue == "") tempCodeValue = tempFilterCode[i];
                  else tempCodeValue += "," + tempFilterCode[i];
                }

                $("#brandCode").val(tempCodeValue);

                if (typeof $("#brandFilterTitle").html() != "undefined") {
                  var tempTitleValue = "";
                  var tempFilterTitleArr = $("#brandFilterTitle")
                    .html()
                    .split(",");
                  var tempFilterTitle = tempFilterTitleArr.reduce(function (
                    a,
                    b
                  ) {
                    if (a.indexOf(b) < 0) a.push(b);
                    return a;
                  },
                  []);

                  for (var i = 0; i < tempFilterTitle.length; i++) {
                    if (tempTitleValue == "")
                      tempTitleValue = tempFilterTitle[i];
                    else tempTitleValue += "," + tempFilterTitle[i];
                  }

                  $("#brandFilterTitle").html(tempTitleValue);
                }

                stateObj.chkSales && $("#checkSale").click();
                if (stateObj.selectedSort) {
                  $("#st2 option:eq(" + stateObj.selectedSort + ")").attr(
                    "selected",
                    "selected"
                  );
                  $("#productOrderCode").val($("#st2").val());
                }

                var pageSize = 14;
                var rows = "";

                var savedListData = data.split("\n");
                for (
                  var idx = displayTopPageNUm - 1;
                  idx < currPageNum;
                  idx++
                ) {
                  rows += makeCategoryListHtml(
                    decompressCategoryList(
                      savedListData.slice(idx * pageSize, (idx + 1) * pageSize)
                    ),
                    idx + 1
                  );
                }

                $("#listBody").html(rows);

                var len = $("#listBody")
                  .find("div.img img")
                  .load(function () {
                    if (--len === 0) {
                      $(document).scrollTop(stateObj.scrollTop || 0);

                      $("#mainPage_wrapper_cover").hide();
                      cacheLoadingFlag = false;
                    }
                  }).length;

                // 상품목록 출력 후 공통 액션 호출
                afterPagingCommonAction(totalProdCount);

                return true;
              } else {
                return false;
              }
            },

            resetCurrPageCache: function () {
              console.log("여기~~~~~~~~~~ resetCurrPageCache 1544:");
              window.sessionStorage.removeItem(listStorageId);
              window.sessionStorage.removeItem(stateStorageId);

              keepPageNum = 0;
            },

            initCache: function () {
              console.log("여기~~~~~~~~~~ initCache 1553:");
              window.sessionStorage.removeItem(listStorageId);
              window.sessionStorage.removeItem(stateStorageId);

              var pageQSource = window.sessionStorage.getItem("savedCatId");
              console.log("0000000000000000000000: ", pageQSource);
              if (pageQSource) {
                console.log("if");
                var pageQueue = JSON.parse(pageQSource);

                // 현재 페이지의 카테고리 아이디 제거
                pageQueue = pageQueue.filter(function (el) {
                  return el !== catId;
                });

                // sessionStorage cache는 최근 5 page만 캐싱. 이번에 새로 진입한 페이지가 캐싱될 것을 감안하여 9 페이지만 남긴다.
                if (pageQueue.length >= cachePageCount) {
                  removePageCatIds = pageQueue.slice(
                    0,
                    pageQueue.length - (cachePageCount - 1)
                  );
                  for (
                    var idx = 0, len = removePageCatIds.length;
                    idx < len;
                    idx++
                  ) {
                    window.sessionStorage.removeItem(
                      removePageCatIds[idx] + ".listData"
                    );
                    window.sessionStorage.removeItem(
                      removePageCatIds[idx] + ".pageState"
                    );
                  }

                  pageQueue = pageQueue.slice(
                    pageQueue.length - (cachePageCount - 1)
                  );
                }

                pageQueue[pageQueue.length] = catId;
                window.sessionStorage.setItem(
                  "savedCatId",
                  JSON.stringify(pageQueue)
                );
              } else {
                console.log("else");
                window.sessionStorage.setItem(
                  "savedCatId",
                  JSON.stringify([catId])
                );
              }
              console.log("======================= initcache");
            },

            hasPageData: function (pageNum) {
              return pageNum < keepPageNum;
            },

            getBuffData: function (pageNum, pageSize) {
              console.log("여기~~~~~~~~~~ getBuffData 1608:");
              if (this.hasPageData(pageNum)) {
                var data = window.sessionStorage.getItem(listStorageId),
                  stateData = window.sessionStorage.getItem(stateStorageId);

                if (data) {
                  var stateObj = $.extend(
                    {},
                    {
                      prodCnt: 0,
                    },
                    stateData && JSON.parse(stateData)
                  );

                  currPageNum = pageNum;
                  console.log("22222222222");
                  return {
                    pagination: {
                      currentPage: pageNum - 1,
                      pageSize: pageSize,
                      totalNumberOfResults: stateObj.prodCnt,
                      numberOfPages:
                        Math.floor((stateObj.prodCnt - 1) / pageSize) + 1,
                      sort: null,
                    },
                    results: decompressCategoryList(
                      data
                        .split("\n")
                        .slice((pageNum - 1) * pageSize, pageNum * pageSize)
                    ),
                  };
                } else {
                  console.log("111111111111111");
                  return {};
                }
              } else {
                console.log("33333333");
                return {};
              }
            },
          };
        }
        console.log("========= session어쩌고");
      })($('#categoryCode').val()); ///////여기 바꿔야

      console.log("?????: ", $('#categoryCode').val());

      var gubunSearchYn = "N";
      var cacheLoadingFlag = false;

      var categoryListList = "";
      var imageUrl = "";
      var hashFirstCheck = false;
      var isNextPage = false;
      var nextPageNum = 1;
      var totalProdCount = 0;
      var displayTopPageNUm = 0;
      var displayPageCount = 20;

      function exchangeRatePrice(koPrice) {
        return exchangeAmt;
      }

      function productListEffect() {
        var $product_list = $(".hs_product_list_wrap .hs_product_list ul li");
        $product_list.each(function () {
          //리스트 스크롤 효과
          if (
            $(window).scrollTop() + $(window).height() >
            $(this).offset().top
          ) {
            $(this).addClass("active");
          } else {
            $(this).removeClass("active");
          }
        });
      }

      function productListMainEffect() {
        var $main_visual_par = $(".hs_product_list_wrap .prodcut_top_cont");
        if ($(window).scrollTop() > $main_visual_par.offset().top) {
          //메인 비주얼 스크롤 효과
          $main_visual_par.find(".img").css({
            backgroundPosition:
              "50% " +
              ($(window).scrollTop() - $main_visual_par.offset().top) / 3 +
              "px",
          });
        } else {
          $main_visual_par.find(".img").css({ backgroundPosition: "50% 0" });
        }
      }

      var isInit = true;
      function openGnbPopup() {
        gnbType = "ca";
        $(".hsome_quickMenu .shop a").click();
      }

      function imageMap(rimg, rwidth, x1, y1, x2, y2, mapid) {
        var rxsize = $("#" + rimg).width();
        var xp1 = (rxsize / rwidth) * x1;
        var yp1 = (rxsize / rwidth) * y1;
        var xp2 = (rxsize / rwidth) * x2;
        var yp2 = (rxsize / rwidth) * y2;

        $("#" + mapid).attr("coords", [xp1, yp1, xp2, yp2].join(", "));
      }

      $(document).ready(function () {
        var subBrand = "";
        var edShopYN = "false";
        var cateYN = "";

        //이전카테고리추가 191028
        $(document).on('click','.previous_category191028 .cate_icon',function(){
            if(!$(this).hasClass('on')){
                $(this).addClass('on');
                $(this).closest('.previous_category191028').find('.cate_list').stop().slideDown('fast');
            }else{
                $(this).removeClass('on');
                $(this).closest('.previous_category191028').find('.cate_list').stop().slideUp('fast');
            }
        });
        $(document).on('click','.btn_ul_close191028',function(){
            $(this).closest('.cate_list').stop().slideUp('fast');
            $(this).closest('.cate_list').closest('.previous_category191028').find('.cate_icon').removeClass('on');
        });

        $("#st2 option:eq(4)").hide();

        var headerTitleHtml =
          '<a href="javascript:noLink();" onclick="openGnbPopup();" class="select_">'+ [[${cateInfo.bigCategory.catename}]] +'</a>';

        var subBrandCode = "";
        if ((edShopYN && subBrandCode != "") || cateYN) {
          headerTitleHtml =
            '<a href=".hs_brand_category_pop2" onclick="popupBtnClick();" class="link btn_popup_trigger select_">여성</a>';
        }
        $("#headerTitle").html(headerTitleHtml);
        if (
          "we05" == "we" ||
          "we05" == "me" ||
          "we05" == "ls"
        ) {
          $("#categoryNav01").addClass("on");
        } else {
          if ("N" == "N" && "Y" == "Y") {
            $("#categoryNav01").addClass("on");
          }
        }

        /*
        var categoryNav01html = "";

        if ("" == "br06" && ("we05" == "br06_me" || "we05" == "br06_ls")) {
          if ("we05" == "br06_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br06_me/br06\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br08" &&
          ("we05" == "br08_we" ||
            "we05" == "br08_me" ||
            "we05" == "br08_kd" ||
            "we05" == "br08_ls")
        ) {
          if ("we05" == "br08_we") {
            categoryNav01html =
              "<a href=\"/ko/c/br08_we/br08\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br08_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br08_me/br08\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br15" &&
          ("we05" == "br15_we" ||
            "we05" == "br15_me" ||
            "we05" == "br15_kd" ||
            "we05" == "br15_ls")
        ) {
          if ("we05" == "br15_we") {
            categoryNav01html =
              '<a href="/ko/c/br15_we/br15' +
              subBrand +
              "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br15_me") {
            categoryNav01html =
              '<a href="/ko/c/br15_me/br15' +
              subBrand +
              "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br35" &&
          ("we05" == "br35_we" ||
            "we05" == "br35_me" ||
            "we05" == "br35_kd" ||
            "we05" == "br35_ls")
        ) {
          if ("we05" == "br35_we") {
            categoryNav01html =
              '<a href="/ko/c/br35_we/br35' +
              subBrand +
              "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          }
        } else if (
          "" == "br47" &&
          ("we05" == "br47_we" ||
            "we05" == "br47_me" ||
            "we05" == "br47_kd" ||
            "we05" == "br47_ls")
        ) {
          if ("we05" == "br47_we") {
            categoryNav01html =
              '<a href="/ko/c/br47_we/br47' +
              subBrand +
              "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br47_me") {
            categoryNav01html =
              '<a href="/ko/c/br47_me/br47' +
              subBrand +
              "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br44" &&
          ("we05" == "br44_we" ||
            "we05" == "br44_me" ||
            "we05" == "br44_kd" ||
            "we05" == "br44_ls")
        ) {
          if ("we05" == "br44_we") {
            categoryNav01html =
              "<a href=\"/ko/c/br44_we/br44\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br44_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br44_me/br44\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br21" &&
          ("we05" == "br21_we" ||
            "we05" == "br21_me" ||
            "we05" == "br21_kd" ||
            "we05" == "br21_ls")
        ) {
          if ("we05" == "br21_we") {
            categoryNav01html =
              "<a href=\"/ko/c/br21_we/br21\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br21_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br21_me/br21\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br20" &&
          ("we05" == "br20_we" ||
            "we05" == "br20_me" ||
            "we05" == "br20_kd" ||
            "we05" == "br20_ls")
        ) {
          if ("we05" == "br20_we") {
            categoryNav01html =
              "<a href=\"/ko/c/br20_we/br20\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br20_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br20_me/br20\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else if (
          "" == "br41" &&
          ("we05" == "br41_we" ||
            "we05" == "br41_me" ||
            "we05" == "br41_kd" ||
            "we05" == "br41_ls")
        ) {
          if ("we05" == "br41_we") {
            categoryNav01html =
              "<a href=\"/ko/c/br41_we/br41\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '여성&nbsp;전체');\">여성&nbsp;전체</a>";
          } else if ("we05" == "br41_me") {
            categoryNav01html =
              "<a href=\"/ko/c/br41_me/br41\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '남성&nbsp;전체');\">남성&nbsp;전체</a>";
          }
        } else {
          categoryNav01html =
            '<a href="/ko/c/we05/' +
            subBrand +
            "\" class=\"name\" onclick=\"GA_Event('카테고리_리스트', '카테고리', '아우터&nbsp;전체');\">아우터&nbsp;전체</a>";
        }

        $("#categoryNav01").html(categoryNav01html);*/
        $(".hsome_footer").hide();

        var scrollDelay = true;
        $(window).scroll(function () {
          //console.log("1916 스크롤 감지");
          var scrollTopNum = $(window).scrollTop() * 1;
          var windowHeightNum = $(window).height() * 1;
          var documentHeightNum = $(document).height() * 1;
          var sumScrollNum = scrollTopNum + windowHeightNum;
          var checkHeightNum = documentHeightNum - 1500;
          if (sumScrollNum >= checkHeightNum) {
            //최하단의 위치값과 동일여부
            if (isNextPage) {
              if (
                gubunSearchYn == "N" &&
                !$(".hsome_allContents").hasClass("disabled") &&
                !cacheLoadingFlag
              ) {
                gubunSearchYn = "Y";
                // scroll paging 시 loading바 노출/비노출 처리
                $(".hsome_loader").show();
                gubunSearch(nextPageNum); //스크롤페이징 ajax 호출 스크립트
                $(".hsome_loader").hide();
              }
            }
          } else if (scrollTopNum < 1500) {
            if (displayTopPageNUm > 1) {
              if (
                gubunSearchYn == "N" &&
                !$(".hsome_allContents").hasClass("disabled") &&
                !cacheLoadingFlag
              ) {
                gubunSearchYn = "Y";
                displayTopPageNUm--;
                // scroll paging 시 loading바 노출/비노출 처리
                $(".hsome_loader").show();
                gubunSearch(displayTopPageNUm, true); //스크롤페이징 ajax 호출 스크립트
                $(".hsome_loader").hide();
              }
            }
          }

          if (scrollDelay) {
            scrollDelay = false;
            setTimeout(function () {
              // 하단 gnb 샵, 마이페이지 호출 시 컨텐츠 영역에 disabled class 설정되면서 scrollTop 값이 0이 됨.
              if (!$(".hsome_allContents").hasClass("disabled")) {
                categoryListCache.changePageState({
                  scrollTop: $(document).scrollTop(),
                });
              }
              scrollDelay = true;
            }, 100);
          }
        });

        $("#handsomeTopBtn").click(function () {
          if (displayTopPageNUm > 1) {
            // top button click 시 스크롤 이벤트로 페이징 처리 되지 않도록 flag 설정한다.
            gubunSearchYn = "Y";

            // 클릭하자마자 바로 scrollTop을 0으로 변경하면 같은 위치에서 화면이 깜빡이는 것처럼 보이므로 scrollTop 이동은 common.js에 있는 핸들러에서 처리하도록 함.
            // 단, 0.3초 후에 이동시키므로 그때까지 페이징이 발생하는 현상 발생 함(3 ~ 4페이지까지 로드). sessionStorage에 있는 데이터 로드하기 때문에 성능 이슈 없음.
            //          // 스크롤 이벤트로 페이징되지 않도록 flag 설정한 이후 scrollTop 조정
            //          $('html, body').scrollTop(0);

            displayTopPageNUm = 1;
            gubunSearch(1); //스크롤페이징 ajax 호출 스크립트
          }

          return false;
        });

        $("#hsDelivery").hide();

        isInit = false;

        $("#st2").on("change", function () {
          $("#productOrderCode").val($(this).val());

          // 정렬 기준 변경 전 cache 데이터 clear하고 1페이지 부터 다시 조회
          // cache data를 load하여 화면 출력 시에는 click event에 대해 재조회 하지 않도록 flag check
          if (!cacheLoadingFlag) {
            categoryListCache.resetCurrPageCache();

            // gubunSearch 호출 전 중복 페이징 방지를 위한 flag 설정. 181122
            gubunSearchYn = "Y";
            gubunSearch(1);
          }
        });

        flagWrapSwiper.update();
      });

      $(window).on({
        pageshow: function (ev) {
          // 페이지 진입 시 html redering 과정에서 scroll 이벤트로 인해 상품정보 요청하지 않도록 조회가능 flag를 조회 중 값으로 설정
          // sessionStorage 데이터로 목록 출력 시에는 cacheLoadingFlag를 사용하여 scroll paging을 막으므로 gubunSearchYn flag는
          // gubunSearch function 호출 시에만 설정하도록 변경. 181122
          //gubunSearchYn = "Y";

          if (
            ev.originalEvent.persisted ||
            (typeof window.performance != "undefined" &&
              window.performance.navigation.type === 2)
          ) {
            // 뒤로가기로 돌아온 경우 cache 데이터로 이전 목록 페이지 구성
            cacheLoadingFlag = true;
            if (categoryListCache.loadCacheData()) {
              console.log("캐시리스트_로드캐시()" + categoryListCache.loadCacheData());
              // cache 데이터로 상품목록 출력 시 이미지 로딩 실패하면 cacheLoadingFlag를 풀어주는 로직이 실행되지 않으므로, setTimeout을 이용하여 1초 후 해당 플래그를 풀어줘서 페이징 가능하도록 하는 로직 추가
              setTimeout(function () {
                $("#mainPage_wrapper_cover").hide();
                cacheLoadingFlag = false;
              }, 1000);
            } else {
              cacheLoadingFlag = false;
              // gubunSearch function 호출 시에만 설정하도록 변경. 181122
              gubunSearchYn = "Y";
              gubunSearch(1);
            }
          } else {
            // 새로 진입한 경우 cache 초기화. 이전 cache 데이터가 있다면 삭제하고 cache 카테고리를 최근 10 카테고리만 유지하도록 조정
            categoryListCache.initCache();
            // gubunSearch function 호출 시에만 설정하도록 변경. 181122
            gubunSearchYn = "Y";
            gubunSearch(1);
          }
        },
      });

      //검색 필터 ======================= start
      var checkBrandCode = "";

      function setCheckSaleCode() {
        if ($("input:checkbox[id=checkSale]").is(":checked") == true) {
          $("#checkSaleCode").val("Y");
        } else {
          $("#checkSaleCode").val("");
        }

        // Sale 조건 조회 전 cache 데이터 clear하고 1페이지 부터 다시 조회
        // cache data를 load하여 화면 출력 시에는 click event에 대해 재조회 하지 않도록 flag check
        if (!cacheLoadingFlag) {
          categoryListCache.resetCurrPageCache();
          // gubunSearch 호출 전 중복 페이징 방지를 위한 flag 설정. 181122
          gubunSearchYn = "Y";
          gubunSearch(1);
        }
      }

      function filterClick(id) {
        $(id).click();
      }

      function filterResetBtnClick() {
        $("#brandCode").val("");
        $("#filterLayerPopupClose").click();
        location.reload();
      }

      function filterApply() {
        $("#filterLayerPopupClose").click();

        if ("false" == "true") {
          if ($("#brandCode").val() == "") {
            $("#brandCode").val("ed");
          }
        }
        // Filter 조건 조회 전 cache 데이터 clear하고 1페이지 부터 다시 조회
        // cache data를 load하여 화면 출력 시에는 click event에 대해 재조회 하지 않도록 flag check
        if (!cacheLoadingFlag) {
          categoryListCache.resetCurrPageCache();
          // gubunSearch 호출 전 중복 페이징 방지를 위한 flag 설정. 181122
          gubunSearchYn = "Y";
          gubunSearch(1);
        }
      }
      //검색 필터 ======================= end

      ///////////////
      function gubunSearch(page, upDown) {
        var listBodyId = "listBodyTemp";

        categoryListList = new CategoryListController(
          "categoryListForm",
          "#" + listBodyId,
          ".paging",
          14
        ); //폼아이디, 리스트공간 셀렉터, 페이징공간 셀렉터, 페이지당 리스트개수
        console.log("여기~~~ gubunSearch");

        //결과
        categoryListList.PARAMS.pageNum = page;
        categoryListList.PARAMS.defaultListHtml = "";
        categoryListList.doWork();
        categoryListList.setRowHtml = function (results) {
          console.log("여기~~~~~~~: categoryListList.setRowHtml");
          console.log("setrowhtml: ", results);
          // 181016 sessionStorage 저장 로직 추가
          // cache에 저장되지 않은 페이지에 대해서만 cache 저장 메소드 호출
          if (!categoryListCache.hasPageData(categoryListList.PARAMS.pageNum)) {
            console.log("여기~~~~~~~: categoryListList.setRowHtml > if");
            console.log("카테고리리스트리스트: ", categoryListList);
            console.log("리졸트", results);
            categoryListCache.addListData({
              pageNum: categoryListList.PARAMS.pageNum,
              listData: results.products,
            });
          }
          console.log("페이지넘: ", categoryListList.PARAMS.pageNum);
          console.log("===============setRowHtml");
          return makeCategoryListHtml(results, categoryListList.PARAMS.pageNum);
          // 181016 sessionStorage 저장 로직 추가 끝
        };

        //리스트 호출후 셋팅(스크롤에 따라)
        categoryListList.afterSetAction = function () {
          console.log("여기~~~~~~~: categoryListList.afterSetAction ");
          console.log(this.PARAMS);
          console.log(this.PARAMS.resourceObjectData.pagination);

          // 조회 대상 총 상품 건수
          totalProdCount =
            this.PARAMS.resourceObjectData.pagination.totalNumberOfResults;
          console.log("\t totalProdCount=", totalProdCount);

          var $listBody = $("#listBody");
          var $listBodyChildren = $listBody.children();
          var listBodyLen = $listBodyChildren.length;

          if (!upDown) {
            // 아래로 스크롤
            console.log("아래 스크롤");
            // 총 페이지 수 보관 - scroll 이벤트에서 다음 페이지 있는지 판단 목적으로 사용
            isNextPage =
              page < this.PARAMS.resourceObjectData.pagination.numberOfPages;
            console.log("\t이즈넥스트페이지", isNextPage);

            // 다음 페이지 번호 계산. 다음 페이지 번호는 현재 페이지번호보다 항상 1이 커야 함.
            nextPageNum = page + 1;

            // 아래로 스크롤인데 1페이지 요청이면 조회 조건이나 정렬방식등의 변화로 새로 조회하는 것으로 간주
            //console.log("컬리스트: ", $currList);
            if (page === 1) {
              console.log("\t페이지가 ", page);
              displayTopPageNUm = 1;
              $listBody.html($currList);
            } else {
              console.log("\t페이지가 ", page);
              if (listBodyLen >= displayPageCount * 14) {
                displayTopPageNUm = page - (displayPageCount - 1);
                var $removeBottomLi = $(
                  "#listBody" + (page - displayPageCount) + "_li13"
                );
                var removePageBottom =
                  $removeBottomLi.position().top +
                  $removeBottomLi.outerHeight();
                var keepScrollTop = $(window).scrollTop();

                var removePageIdx = page - displayPageCount;

                for (var idx = 0; idx < 14; idx++)
                  $listBody
                    .find("#listBody" + removePageIdx + "_li" + idx)
                    .remove();
                $listBody.find("li:last-child").after($currList);

                $(window).scrollTop(
                  keepScrollTop - removePageBottom + $listBody.position().top
                );
              } else if (
                listBodyLen < displayPageCount * 14 &&
                listBodyLen >= 14
              ) {
                $listBody.find("li:last-child").after($currList);
              }
            }
          } else {
            // 위로 스크롤
            console.log("위로");

            // displayTopPageNum > 1인 상태에서 위로 스크롤 이벤트 발생시에만 아래 로직 실행. 즉, 이미 displayPageCount을 초과하여 페이징이 진행된 이후이므로  목록 하단 한페이지를 제거하고 조회하려는 페이지를 상단에 추가하는 경우에만 아래 로직이 수행됨.
            displayTopPageNUm = page;

            // 다음 페이지 번호 계산. 위로 이동하면서 페이지 변경 발생한 경우는 출력 페이지가 displayPageCount만큼 출력 중인 상태이므로 다음페이지 번호는 가장 아래 페이지 + 1(page + displayPageCount)로 계산.
            nextPageNum = page + displayPageCount;

            // 총 페이지 수 보관 - scroll 이벤트에서 다음 페이지 있는지 판단 목적으로 사용
            isNextPage =
              nextPageNum <=
              this.PARAMS.resourceObjectData.pagination.numberOfPages;

            var keepScrollTop = $(window).scrollTop();

            var removePageIdx = page + displayPageCount;
            for (var idx = 0; idx < 14; idx++)
              $listBody
                .find("#listBody" + removePageIdx + "_li" + idx)
                .remove();
            $listBody.find("li:first-child").before($currList);

            var $appendBottomLi = $("#listBody" + page + "_li13");
            var appendPageBottom =
              $appendBottomLi.position().top + $appendBottomLi.outerHeight();

            $(window).scrollTop(keepScrollTop + appendPageBottom);
          }

          $("#mainPage_wrapper_cover").hide();
          afterPagingCommonAction(totalProdCount);

          // html 생성하는 동안 샵 메뉴 클릭될 가능성에 대비하여 diabled 클래스 체크.
          // disabled class 설정 시 scrollTop이 0이 됨.
          if (!$(".hsome_allContents").hasClass("disabled")) {
            categoryListCache.changePageState({});
            console.log("흠2~");
          }else{
            console.log("흠~");
          }
          console.log("============= afterSetAction");
        };
        console.log("============= gubunSearch");
      }

      // 상품목록 페이징 출력 후 공통 액션
      function afterPagingCommonAction(resultCount) {
        console.log("여기~~~~~~~: afterPagingCommon", resultCount);
        var errorImage = "/_ui/handsomemobile/images/common/no_img.jpg";

        $("img.lazy.newpage").lazyload({
          threshold: 20,
          load: function () {
            $(this).removeClass("newpage");
          },
          error: function (event) {
            var $this = $(this);
            var prodIndex = $this.data("prod-idx");
            var $imgCheck = $(
              "#imageCheck0" + $this.data("img-idx") + "" + prodIndex
            );
            var imageCheckArr = $imgCheck.val().split("!||!");

            var onErrorImgChangeImg = imageCheckArr[0];
            var onErrorImgChangeCode = imageCheckArr[1];
            var changeImgUrl = "";

            var retryCnt = $imgCheck.data("retry-count");
            if (retryCnt) {
              retryCnt++;
            } else {
              retryCnt = 1;
            }

            if (retryCnt > 5) {
              changeImgUrl = errorImage;
            } else {
              if (onErrorImgChangeImg.indexOf("thehandsome") > -1) {
                if (onErrorImgChangeImg.indexOf("newmedia") == -1) {
                  if (
                    onErrorImgChangeImg.indexOf(
                      "media-staging.thehandsome.com"
                    ) > -1
                  ) {
                    changeImgUrl = onErrorImgChangeImg.replace("-staging", "");
                  } else if (
                    onErrorImgChangeImg.indexOf(
                      "media-development.thehandsome.com"
                    ) > -1
                  ) {
                    changeImgUrl = onErrorImgChangeImg.replace(
                      "-development",
                      ""
                    );
                  } else {
                    if (
                      onErrorImgChangeCode != "" &&
                      onErrorImgChangeCode.length > 10
                    ) {
                      var checkIndex =
                        prodIndex - 14 * Math.floor(prodIndex / 14);
                      if (checkIndex == 4 || checkIndex == 10) {
                        var changeImgUrl = onErrorImgChangeImg.replace(
                          "media",
                          "newmedia"
                        );
                        var changeImgUrlArr = changeImgUrl.split("//");
                        var changeImgUrlArr2 = changeImgUrlArr[1].split("/");
                        changeImgUrl = changeImgUrlArr[0] + "//";
                        for (var i = 0; i < changeImgUrlArr2.length - 1; i++) {
                          changeImgUrl += changeImgUrlArr2[i] + "/";
                        }
                        changeImgUrl += onErrorImgChangeCode + "_W01.jpg";
                      } else {
                        changeImgUrl =
                          "http://media.thehandsome.com/" +
                          $this.attr("targetCode") +
                          "_" +
                          $this.attr("id").split("_")[0] +
                          ".jpg";
                      }
                    }
                  }
                } else {
                  changeImgUrl = onErrorImgChangeImg.replace(
                    "newmedia",
                    "media"
                  );
                }
              } else {
                changeImgUrl = errorImage;
              }
            }

            $("#newImage1_" + prodIndex).val(changeImgUrl);
            $imgCheck.data("retry-count", retryCnt); //무한루프 방지
            $(event.currentTarget).attr("src", changeImgUrl);
          },
        });

        if (!isNextPage) {
          $(".hsome_footer").show();
        }
        //리스트 초기화

        //전체 상품수 세팅
        if (resultCount == 0) {
          $("#listBody").html(
            '<li class="full active"><div class="info_cont"><p class="brand" style="font-size:16px;">조건에 맞는 상품 정보가 없습니다.</p></div></li>'
          );
        }
        $("#totalSpan").html(addComma(resultCount) + " 개");
        gubunSearchYn = "N";
        console.log("===================afterPagingCommonAction");
      }

      function makeCategoryListHtml(results, pageNum) {
        console.log("여기~~~~~~~: makeCategoryListHtml");
        console.log(results, pageNum);

        var rows = "";

        if (results.length > 0) {
          var ecommerceListSize = window.sessionStorage.getItem(
            "category_ecommerceDataList_size"
          );
          ecommerceListSize =
            ecommerceListSize > 0 ? Number(ecommerceListSize) + Number(1) : 1;
          window.sessionStorage.setItem(
            "category_ecommerceDataList_size",
            ecommerceListSize
          );
          window.sessionStorage.setItem(
            "normal_cate_ecommerceDataList_" + ecommerceListSize,
            JSON.stringify(results)
          );
        }

        for (var idx = 0, len = results.length; idx < len; idx++) {
          var product = results[idx];

          var totalIndex = (pageNum - 1) * 14 + idx;

          var liClass = "float";
          if (idx == 4 || idx == 11) {
            liClass = "big";
          }

          if (product.pcimg2 != null) {
            product.productStyleCode = product.pcid;
          }

          var listTag =
            '<li class="' +
            liClass +
            ' active" id="listBody' +
            pageNum +
            "_li" +
            idx +
            '" > \n';
            listTag +=
            '    <a href="/p/detail/'+ product.pcid +'" class="categoryImgBox"\> \n';
          listTag += '        <div class="img">';

          //ㅇㅣ미지 시작
          let pcimg2 = product.pcimg2;
          if (idx == 4 || idx == 11) {
            pcimg2 = pcimg2.replace("_T01.", "_W01.");
          }

          listTag +=
            '            <img src="' +
            pcimg2 +
            '" data-original="' +
            pcimg2 +
            '" data-prod-idx="' +
            totalIndex +
            '" data-img-idx="1" id="T01_IMG_' +
            totalIndex +
            '" targetCode="' +
            product.pcid +
            '" alt="' +
            product.pname +
            '" text="' +
            pcimg2 +
            '" class="respon_image lazy newpage" /> \n';
          listTag +=
            "            <input type='hidden' id='imageCheck01" +
            totalIndex +
            "' value='" +
            pcimg2 +
            "!||!" +
            product.pcid +
            "'/>";
          listTag +=
            "            <input type='hidden' id='newImage1_" +
            totalIndex +
            "' value='" +
            pcimg2 +
            "'/>";

          //이미지 끝

          listTag += "        </div> \n";
          listTag += "        </a> \n";

          listTag += '        <div class="info_cont"> \n';
          listTag += '            <div class="color_chip"> \n';

          var cur_pcid = product.productStyleCode; //pcid

          //색상
          if (product.colors.length > 0) {
            let colorChipImg = "";

            for (let k = 0; k < product.colors.length; k++) {
              let cssWhite = "";
              let color = product.colors[k];

              let colorChip = color.pccolorcode;
              if (colorChip == "#ffffff") {
                cssWhite = " white";
              }

              var cssOn = "";
              if (cur_pcid == color.pcid) {
                cssOn = " on";
              }

              listTag +=
                  '                <a href="javascript:noLink();" onclick="chgColorChip(' +
                  totalIndex +
                  ", '" +
                  color.pcid + "', '"+ color.pcimg2 +
                  "');\"> \n";

              colorChipImg =
                "background:" +
                color.pccolorcode +
                " url('" +
                color.pcchipimg +
                "/dims/resize/40x40')";

              listTag +=
                '                <button class="chip' +
                cssWhite +
                cssOn +
                '" id="slide' +
                color.pcid +
                '" style="' +
                colorChipImg +
                ';"></button></a>\n';
            } //end 색상
          }
          //end 색상
          listTag += "            </div> \n";
          listTag +=
            '            <p class="brand">' + product.bname + "</p> \n";
          listTag += '            <p class="name">' + product.pname + "</p> \n";

          var productPrice = "";
          var productSalePrice = "";
          var productSalePerCent = 0;

          productPrice = "￦" + addComma(product.pcprice);
          productSalePrice = "";
          productSalePerCent = 0;

          listTag +=
            '            <p class="price" id="listPrice' +
            totalIndex +
            '"> <span id="price_' +
            product.pcid +
            '">' +
            productPrice +
            "</span></p> \n";
          // console.log("22512: ", listTag);
          // }

          // listTag +=
          //   '            <div id="etc' +
          //   product.productBaseCode +
          //   '"class="etc">';
          // }

          // if (product.productAvailableYn == 0) {
          //   listTag += '                <span class="sale">SOLDOUT</span> \n';
          // } else if (product.productAvailableYn == 1) {
          //   var chkLineYn = false;
          //   if ("" != "OU" && productFlagTemp.length > 0) {
          //     if (
          //       (product.available4pmSum >= 1 && checkTime != "") ||
          //       (chkQuick == "QUICK" &&
          //         product.availableQuick >= 1 &&
          //         checkQuickTime == "true") ||
          //       (chkAthome == "ATHOME" && product.availableAtHome >= 1)
          //     ) {
          //       if (
          //         product.productReviewCount != "0" &&
          //         product.productReviewCount != null
          //       ) {
          //         chkLineYn = true;
          //       }
          //     }
          //   }
          //   if (chkLineYn && productFlagTemp == "") {
          //     chkLineYn = false;
          //   }
          // }
          // listTag += "            </div>";
          listTag += "        </div>";
          listTag += "    </a>";

          /*
          if (product.productWishlist == true) {
            listTag +=
              '    <button type="button" class="like on" id="' +
              product.productStyleCode +
              'Like" onclick="callWishListClick($(this), \'' +
              product.productStyleCode +
              "', '" +
              escape(product.productName) +
              "', '" +
              ecommerceListSize +
              "','" +
              idx +
              "');\" data-value='" +
              product.productStyleCode +
              "'>찜하기</button>";
          } else {
            listTag +=
              '    <button type="button" class="like" id="' +
              product.productStyleCode +
              'Like" onclick="callWishListClick($(this), \'' +
              product.productStyleCode +
              "', '" +
              escape(product.productName) +
              "', '" +
              ecommerceListSize +
              "','" +
              idx +
              "');\" data-value='" +
              product.productStyleCode +
              "'>찜하기</button>";
          }
          */

          listTag += "</li>";

          rows += listTag;
        } //end for
        //console.log(rows);
        console.log("========= makeCategoryListHtml");
        return rows;
      }

      function chgColorChip(index, code, pcimg2) {
        console.log("chgColorChip 2623 호출");

        //중복 호출 방지(동일한 이미지가 중복으로 호출시 에러 이미지로 판단)
        if ($("[targetCode='" + code + "']").length == 0) {
          var url = $("#newImage1_" + index).val();
          var target = url.substring(url.lastIndexOf("/"));
          var checkIndex = index - 14 * parseInt(index / 14);

          // if (checkIndex == 5 || checkIndex == 13) {
          //   var src2 = url.replace(
          //     target,
          //     "/" +
          //       code +
          //       "_T02" +
          //       $("#T02_IMG_" + index)
          //         .attr("src")
          //         .substring(
          //           $("#T02_IMG_" + index)
          //             .attr("src")
          //             .lastIndexOf(".")
          //         )
          //   );
          //   $("#T02_IMG_" + index).attr("src", src2);
          //   $("#T02_IMG_" + index).attr("targetCode", code);
          // }

          $("#T01_IMG_" + index).attr("src", pcimg2);
          $("#T01_IMG_" + index).attr("targetCode", code);

          $("#T01_IMG_" + index)
            .closest(".categoryImgBox");
          // $("#T01_IMG_" + index)
          //   .closest(".categoryImgBox")
          //   .parent()
          //   .find("button.like")
          //   .attr("data-value", code);
        }
      }

      function popupBtnClick() {
        $(".hsome_quickMenu").removeClass("active");
      }

      function addWishListClick(productBaseCode) {
        var lc = new layerConfirm("로그인이 필요합니다", "확인", "취소");
        lc.cancleAction = function () {
          //취소 호출 펑션
          $("#" + productBaseCode + "Like").removeClass("on");
        };

        lc.confirmAction = function () {
          //확인 호출 펑션
          location.href = "/ko/member/login";
        };

        addWishList(productBaseCode);
      }

      function addWishList(productBaseCode) {
        $.ajax({
          url: "/ko/wishlist/add-product-action",
          type: "GET",
          data: { productCode: productBaseCode, type: "toggle" },
          success: function (msg) {},
          error: function (xhr, Status, error) {},
        });
      }

      var flagWrapSwiper = new Swiper(".flag_wrap.case.swiper-container", {
        slidesPerView: "auto",
        freeMode: true,
        spaceBetween: 6,
        freeModeMomentumBounce: false,
      });

      $(document).on("click", ".hs_product_list .chip", function () {
        $(this).closest("li").find(".chip").removeClass("on");
        $(this).addClass("on");
      });

      var filterSwiper = new Swiper(".shipping.swiper-container", {
        slidesPerView: "auto",
        freeMode: true,
      });

      $(document).on(
        "click",
        ".filter_wrap.hsDelivery1902 .fitguide_tooltip .hs_tooltip_wrap .ico_btn",
        function () {
          if ($(".hs_product_list_wrap .tooltip_cont").hasClass("on")) {
            $(".hs_product_list_wrap .tooltip_cont").removeClass("on");
          } else {
            $(
              ".hs_product_list_wrap .hs_tooltip_wrap .tooltip_cont"
            ).removeClass("on");
            $(".hs_product_list_wrap .tooltip_cont").addClass("on");
          }
          return false;
        }
      );
      $(document).on(
        "click",
        ".hs_product_list_wrap .tooltip_cont .close",
        function () {
          $(".hs_product_list_wrap .tooltip_cont").removeClass("on");
          return false;
        }
      );

      function callWishListClick(ele, styleCd, escapeNm, page, idx) {
        addWishListClick(styleCd);
      }
      //]]>
    </script>

    <!-- lazy load 관련 jquery plugin 추가 -->
    <script
      src="/_ui/handsomemobile/js/jquery.lazyload.js"
      type="text/javascript"
    ></script>
    <!-- Google 리마케팅 태그 코드 -->

    <!-- // 택배사 선택 팝업 -->
    <!-- // 팝업 -->
  </body>

  <script th:replace="~{includes/mobile :: mobile}"></script>
</html>
